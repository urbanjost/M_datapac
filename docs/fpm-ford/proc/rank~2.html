<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Statistics">
    
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>RANK &ndash; M_datapac</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">M_datapac </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>RANK
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.3% of total for procedures.">85 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/M_datapac_s.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/m_datapac_s.f90.html'>M_datapac_s.f90</a></li>
    
     <li><a href='../module/m_datapac_s.html'>M_datapac_s</a></li>
    
  
     <li class="active">RANK</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 


<div class="panel panel-primary">
  <div class="panel-heading
  text-left"><h3 class="panel-title"><a data-toggle="collapse"
  href="#common-0">Common Blocks</a></h3></div>
  <div id="common-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/rank~2.html#common-block4_real32">BLOCK4_real32</a>
      
    </div>
  </div>
</div>



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-xs~3">XS</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-an~87">an</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-avrank~2">avrank</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-hold~146">hold</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-i~208">i</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-ibran~6">ibran</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-iupper~61">iupper</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-j~73">j</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-jmin~5">jmin</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-jp1~6">jp1</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-k~53">k</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-nm1~13">nm1</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-rprev~2">rprev</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-xprev~2">xprev</a>
      
    </div>
  </div>
</div>




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/rank~2.html#src">RANK</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine RANK(X, N, Xr)
    
    
   
</h2>
    
  


    
    <h2 id="name">NAME</h2>
<div class="codehilite"><pre><span></span><code>rank(3f) - [M_datapac:SORT] rank a vector of sample observations
</code></pre></div>

<h2 id="synopsis">SYNOPSIS</h2>
<div class="codehilite"><pre><span></span><code>   SUBROUTINE RANK(X,N,Xr)

    REAL(kind=wp),intent(in)  :: X(:)
    INTEGER,intent(in)        :: N
    REAL(kind=wp),intent(out) :: Xr(:)
</code></pre></div>

<h2 id="description">DESCRIPTION</h2>
<div class="codehilite"><pre><span></span><code><span class="nv">RANK</span><span class="ss">(</span><span class="mi">3</span><span class="nv">f</span><span class="ss">)</span> <span class="nv">ranks</span> <span class="ss">(</span><span class="nv">in</span> <span class="nv">ascending</span> <span class="nv">order</span><span class="ss">)</span> <span class="nv">the</span> <span class="nv">N</span> <span class="nv">elements</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">precision</span>
<span class="nv">precision</span> <span class="nv">vector</span> <span class="nv">X</span>, <span class="nv">and</span> <span class="nv">puts</span> <span class="nv">the</span> <span class="nv">resulting</span> <span class="nv">N</span> <span class="nv">ranks</span> <span class="nv">into</span> <span class="nv">the</span> <span class="nv">precision</span>
<span class="nv">precision</span> <span class="nv">vector</span> <span class="nv">XR</span>.

<span class="nv">RANK</span><span class="ss">(</span><span class="mi">3</span><span class="nv">f</span><span class="ss">)</span> <span class="nv">gives</span> <span class="nv">the</span> <span class="nv">data</span> <span class="nv">analyst</span> <span class="nv">the</span> <span class="nv">ability</span> <span class="nv">to</span> <span class="ss">(</span><span class="k">for</span> <span class="nv">example</span><span class="ss">)</span> <span class="nv">rank</span>
<span class="nv">the</span> <span class="nv">data</span> <span class="nv">preliminary</span> <span class="nv">to</span> <span class="nv">certain</span> <span class="nv">distribution</span><span class="o">-</span><span class="nv">free</span> <span class="nv">analyses</span>.
</code></pre></div>

<h2 id="notes">NOTES</h2>
<p>The rank of the first element of the vector X will be placed in the
   first position of the vector XR, the rank of the second element of the
   vector X will be placed in the second position of the vector XR, etc.</p>
<p>The smallest element in the vector X will have a rank of 1 (unless
   ties exist).  the largest element in the vector X will have a rank of N
   (unless ties exist).</p>
<p>Although ranks are usually (unless ties exist) integral values from
   1 to N, it is to be noted that they are outputted as REAL values in
   the vector XR.  XR is so as to be consistent with the fact that all
   vector arguments in all other datapac subroutines are REAL; but more
   importantly, because ties frequently do exist in data sets and so some
   of the resulting ranks will be non-integral and so the output vector
   of ranks must necessarily be REAL and not INTEGER.</p>
<p>The input vector X remains unaltered.</p>
<p>Due to conflicting use of labeled common /block2_real32/ by this
   rank subroutine and the SPCORR (Spearman rank correlation coefficient)
   subroutine, the vector XS of this rank subroutine has been placed in
   labeled common /block4_real32/</p>
<p>The first and third arguments in the calling sequence may be identical;
   that is, an &lsquo;in place&rsquo; ranking is permitted. The calling sequence
   call RANK(X,N,X) is valid, if desired.</p>
<p>The sorting algorthm used herein is the binary sort. This algorthim
   is extremely fast as the following time trials indicate.  These time
   trials were carried out on the UNIVAC 1108 EXEC 8 system at NBS in
   August of 1974.  by way of comparison, the time trial values for the
   easy-to-program but extremely inefficient bubble sort algorithm have
   also been included&ndash;</p>
<p>Number of random        Binary sort       Bubble sort
    numbers sorted
     n = 10                 .002 sec          .002 sec
     n = 100                .011 sec          .045 sec
     n = 1000               .141 sec         4.332 sec
     n = 3000               .476 sec        37.683 sec
     n = 10000             1.887 sec      not computed</p>
<h2 id="input-arguments">INPUT ARGUMENTS</h2>
<div class="codehilite"><pre><span></span><code><span class="nv">X</span>     <span class="nv">The</span> <span class="nv">vector</span> <span class="nv">of</span> <span class="nv">observations</span> <span class="nv">to</span> <span class="nv">be</span> <span class="nv">ranked</span>.
<span class="nv">N</span>     <span class="nv">The</span> <span class="nv">integer</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">observations</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">vector</span> <span class="nv">X</span>.
      <span class="nv">The</span> <span class="nv">maximum</span> <span class="nv">allowable</span> <span class="nv">value</span> <span class="nv">of</span> <span class="nv">N</span> <span class="k">for</span> <span class="nv">this</span> <span class="nv">subroutine</span> <span class="nv">is</span> <span class="mi">7500</span>.
</code></pre></div>

<h2 id="output-arguments">OUTPUT ARGUMENTS</h2>
<div class="codehilite"><pre><span></span><code>XR    The vector into which the ranks of the X values will be placed
      (in ascending order)
</code></pre></div>

<h2 id="examples">EXAMPLES</h2>
<p>Sample program:</p>
<div class="codehilite"><pre><span></span><code><span class="nv">program</span> <span class="nv">demo_rank</span>
<span class="nv">use</span> <span class="nv">M_datapac</span>, <span class="nv">only</span> : <span class="nv">rank</span>
<span class="nv">implicit</span> <span class="nv">none</span>
<span class="o">!</span> <span class="k">call</span> <span class="nl">rank</span><span class="ss">(</span><span class="nv">x</span>,<span class="nv">y</span><span class="ss">)</span>
<span class="k">end</span> <span class="nv">program</span> <span class="nv">demo_rank</span>
</code></pre></div>

<p>Results:</p>
<h2 id="author">AUTHOR</h2>
<div class="codehilite"><pre><span></span><code>The original DATAPAC library was written by James Filliben of the
Statistical Engineering Division, National Institute of Standards
and Technology.
</code></pre></div>

<h2 id="maintainer">MAINTAINER</h2>
<div class="codehilite"><pre><span></span><code>John Urban, 2022.05.31
</code></pre></div>

<h2 id="license">LICENSE</h2>
<div class="codehilite"><pre><span></span><code>CC0-1.0
</code></pre></div>

<h2 id="references">REFERENCES</h2>
<ul>
<li>CACM March 1969, page 186 (Binary Sort Algorithm by Richard
     C. Singleton).</li>
<li>CACM January 1970, page 54.</li>
<li>CACM October 1970, page 624.</li>
<li>JACM January 1961, page 41.</li>
</ul>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x~228"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>X</strong>(:)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n~190"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>N</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xr~2"></span>real(kind=wp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Xr</strong>(:)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 


<div class="panel panel-primary">
  <div class="panel-heading
  text-left"><h3 class="panel-title"><a data-toggle="collapse"
  href="#common-1">Common Blocks</a></h3></div>
  <div id="common-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/rank~2.html#common-block4_real32">BLOCK4_real32</a>
      
    </div>
  </div>
</div>



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-xs~3">XS</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-an~87">an</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-avrank~2">avrank</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-hold~146">hold</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-i~208">i</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-ibran~6">ibran</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-iupper~61">iupper</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-j~73">j</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-jmin~5">jmin</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-jp1~6">jp1</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-k~53">k</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-nm1~13">nm1</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-rprev~2">rprev</a>
      
      <a class="list-group-item" href="../proc/rank~2.html#variable-xprev~2">xprev</a>
      
    </div>
  </div>
</div>




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/rank~2.html#src">RANK</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    
    <section>
      <h2>Common Blocks</h2>
      
      
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="common-block4_real32"></span><h3>
      <a data-toggle="popover" data-html="true" tabindex="0" 
     data-trigger="focus"
   data-content="<h4>Used Elsewhere:</h4>">common /BLOCK4_real32/</a>
      
  </h3></div>
  <div class="panel-body">
    
    
    
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xs~4"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>XS</strong>(7500)</td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    
</div>
</div>

      
    </section>
    <br>
    <script>
      $(function () {
      $('[data-toggle="popover"]').popover()
      })
    </script>
    

    
    <section>    
      <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xs~3"></span>real(kind=wp),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>XS</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-an~87"></span>real(kind=wp),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>an</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-avrank~2"></span>real(kind=wp),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>avrank</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-hold~146"></span>real(kind=wp),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>hold</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-i~208"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>i</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ibran~6"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>ibran</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iupper~61"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>iupper</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-j~73"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>j</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-jmin~5"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>jmin</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-jp1~6"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>jp1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-k~53"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>k</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nm1~13"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>nm1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rprev~2"></span>real(kind=wp),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>rprev</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xprev~2"></span>real(kind=wp),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>xprev</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">SUBROUTINE </span><span class="n">RANK</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Xr</span><span class="p">)</span>
<span class="kt">REAL</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">X</span><span class="p">(:)</span>
<span class="kt">INTEGER</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">N</span>
<span class="kt">REAL</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Xr</span><span class="p">(:)</span>

<span class="kt">REAL</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">an</span> <span class="p">,</span> <span class="n">avrank</span> <span class="p">,</span> <span class="n">hold</span> <span class="p">,</span> <span class="n">rprev</span> <span class="p">,</span> <span class="n">xprev</span> <span class="p">,</span> <span class="n">XS</span>
<span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">i</span> <span class="p">,</span> <span class="n">ibran</span> <span class="p">,</span> <span class="n">iupper</span> <span class="p">,</span> <span class="n">j</span> <span class="p">,</span> <span class="n">jmin</span> <span class="p">,</span> <span class="n">jp1</span> <span class="p">,</span> <span class="n">k</span> <span class="p">,</span> <span class="n">nm1</span>
<span class="k">COMMON</span> <span class="o">/</span><span class="n">BLOCK4_real32</span><span class="o">/</span> <span class="n">XS</span><span class="p">(</span><span class="mi">7500</span><span class="p">)</span>

<span class="c">!---------------------------------------------------------------------</span>
      <span class="n">an</span> <span class="o">=</span> <span class="n">N</span>
      <span class="n">iupper</span> <span class="o">=</span> <span class="mi">7500</span>
<span class="c">!</span>
<span class="c">!     CHECK THE INPUT ARGUMENTS FOR ERRORS</span>
<span class="c">!</span>
      <span class="k">IF</span> <span class="p">(</span> <span class="n">N</span><span class="o">&lt;</span><span class="mi">1</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">N</span><span class="o">&gt;</span><span class="n">iupper</span> <span class="p">)</span> <span class="k">THEN</span>
<span class="k">         WRITE</span> <span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99001</span><span class="p">)</span> <span class="n">iupper</span>
         <span class="mi">99001</span> <span class="k">FORMAT</span><span class="p">(&amp;</span>
         <span class="p">&amp;</span> <span class="s1">&#39; ***** FATAL ERROR--THE SECOND INPUT ARGUMENT TO RANK(3f) IS OUTSIDE THE ALLOWABLE (1,&#39;</span><span class="p">,</span><span class="n">I0</span><span class="p">,</span><span class="s1">&#39;) INTERVAL *****&#39;</span><span class="p">)</span>
         <span class="k">WRITE</span> <span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99002</span><span class="p">)</span> <span class="n">N</span>
         <span class="mi">99002</span> <span class="k">FORMAT</span> <span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;***** THE VALUE OF THE ARGUMENT IS &#39;</span><span class="p">,</span><span class="n">I0</span><span class="p">,</span><span class="s1">&#39; *****&#39;</span><span class="p">)</span>
         <span class="k">RETURN</span>
<span class="k">      ELSE</span>
<span class="k">         IF</span> <span class="p">(</span> <span class="n">N</span><span class="o">==</span><span class="mi">1</span> <span class="p">)</span> <span class="k">THEN</span>
<span class="k">            WRITE</span> <span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99003</span><span class="p">)</span>
            <span class="mi">99003</span> <span class="k">FORMAT</span> <span class="p">(</span><span class="s1">&#39; ***** NON-FATAL DIAGNOSTIC--THE SECOND INPUT ARGUMENT TO RANK(3f) HAS THE VALUE 1 *****&#39;</span><span class="p">)</span>
            <span class="n">Xr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0_wp</span>
            <span class="k">RETURN</span>
<span class="k">         ELSE</span>
<span class="k">            </span><span class="n">hold</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">,</span> <span class="n">N</span>
               <span class="k">IF</span> <span class="p">(</span> <span class="n">X</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/=</span><span class="n">hold</span> <span class="p">)</span> <span class="k">GOTO </span><span class="mi">50</span>
            <span class="k">ENDDO</span>
<span class="k">            WRITE</span> <span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99004</span><span class="p">)</span> <span class="n">hold</span>
            <span class="mi">99004</span> <span class="k">FORMAT</span> <span class="p">(</span><span class="s1">&#39; ***** NON-FATAL DIAGNOSTIC--THE FIRST INPUT ARGUMENT (A VECTOR) TO RANK(3f) HAS ALL ELEMENTS = &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="p">&amp;</span> <span class="n">E15</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39; *****&#39;</span><span class="p">)</span>
            <span class="n">avrank</span> <span class="o">=</span> <span class="p">(</span><span class="n">an</span><span class="o">+</span><span class="mf">1.0_wp</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0_wp</span>
            <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">N</span>
               <span class="n">Xr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">avrank</span>
            <span class="k">ENDDO</span>
<span class="k">            RETURN</span>
<span class="k">         ENDIF</span>
<span class="c">!</span>
<span class="c">!-----START POINT-----------------------------------------------------</span>
<span class="c">!</span>
<span class="c">!     FIRST SORT THE DATA FROM THE INPUT VECTOR X</span>
<span class="c">!     INTO THE INTERMEDIATE STORAGE VECTOR XS.</span>
<span class="c">!</span>
 <span class="mi">50</span>      <span class="k">CALL </span><span class="n">SORT</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">XS</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!     NOW DETERMINE THE RANKS.</span>
<span class="c">!     THE BASIC ALGORITHM IS TO TAKE A GIVEN ELEMENT</span>
<span class="c">!     IN THE ORIGINAL INPUT VECTOR X,</span>
<span class="c">!     AND SCAN THE SORTED VALUES IN THE XS VECTOR</span>
<span class="c">!     UNTIL A MATCH IS FOUND;</span>
<span class="c">!     WHEN A MATCH IS FOUND, THEN THE RANK FOR THAT</span>
<span class="c">!     VALUE IN THE XS VECTOR IS DETERMINED.</span>
<span class="c">!     THAT RANK IS THEN WRITTEN INTO THAT POSITION</span>
<span class="c">!     IN THE OUTPUT Y VECTOR WHICH CORRESPONDS TO THE POSITION OF THE</span>
<span class="c">!     GIVEN ELEMENT OF INTEREST IN THE ORIGINAL X VECTOR.</span>
<span class="c">!     THE CODE IS LENGTHENED FROM THIS BASIC ALGORITHM</span>
<span class="c">!     BY A SECTION WHICH CUTS DOWN THE SEARCH IN THE XS VECTOR,</span>
<span class="c">!     AND BY A SECTION WHICH OBVIATES (UNDER CERTAIN CIRCUMSTANCES)</span>
<span class="c">!     THE NEED FOR RECALCULATING THE RANK OF AN ELEMENT IN XS.</span>
<span class="c">!</span>
         <span class="n">nm1</span> <span class="o">=</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span>
         <span class="n">xprev</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
         <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">N</span>
            <span class="n">jmin</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">IF</span> <span class="p">(</span> <span class="n">X</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;</span><span class="n">xprev</span> <span class="p">)</span> <span class="k">THEN</span>
<span class="k">               </span><span class="n">jmin</span> <span class="o">=</span> <span class="n">k</span>
               <span class="k">IF</span> <span class="p">(</span> <span class="n">jmin</span><span class="o">&gt;=</span><span class="n">N</span> <span class="p">)</span> <span class="k">THEN</span>
<span class="k">                  IF</span> <span class="p">(</span> <span class="n">jmin</span><span class="o">==</span><span class="n">N</span> <span class="p">)</span> <span class="k">GOTO </span><span class="mi">60</span>
                  <span class="n">ibran</span> <span class="o">=</span> <span class="mi">1</span>
                  <span class="k">WRITE</span> <span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99007</span><span class="p">)</span> <span class="n">ibran</span>
                  <span class="k">WRITE</span> <span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99005</span><span class="p">)</span> <span class="n">jmin</span>
                  <span class="mi">99005</span> <span class="k">FORMAT</span> <span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;JMIN = &#39;</span><span class="p">,</span><span class="n">I0</span><span class="p">)</span>
                  <span class="k">STOP</span>
<span class="k">               ENDIF</span>
<span class="k">            </span><span class="n">ELSEIF</span> <span class="p">(</span> <span class="n">i</span><span class="o">/=</span><span class="mi">1</span> <span class="p">)</span> <span class="k">THEN</span>
<span class="k">               IF</span> <span class="p">(</span> <span class="n">X</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="n">xprev</span> <span class="p">)</span> <span class="k">THEN</span>
<span class="k">                  </span><span class="n">Xr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">rprev</span>
                  <span class="k">GOTO </span><span class="mi">80</span>
               <span class="k">ENDIF</span>
<span class="k">            ENDIF</span>
<span class="k">            DO </span><span class="n">j</span> <span class="o">=</span> <span class="n">jmin</span> <span class="p">,</span> <span class="n">nm1</span>
               <span class="k">IF</span> <span class="p">(</span> <span class="n">X</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="n">XS</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<span class="k">                  </span><span class="n">jp1</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
                  <span class="k">DO </span><span class="n">k</span> <span class="o">=</span> <span class="n">jp1</span> <span class="p">,</span> <span class="n">N</span>
                     <span class="k">IF</span> <span class="p">(</span> <span class="n">XS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">/=</span><span class="n">XS</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span> <span class="k">GOTO </span><span class="mi">55</span>
                  <span class="k">ENDDO</span>
<span class="k">                  </span><span class="n">k</span> <span class="o">=</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span>
 <span class="mi">55</span>               <span class="n">avrank</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
                  <span class="n">avrank</span> <span class="o">=</span> <span class="n">avrank</span><span class="o">/</span><span class="mf">2.0_wp</span>
                  <span class="n">Xr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">avrank</span>
                  <span class="k">GOTO </span><span class="mi">80</span>
               <span class="k">ENDIF</span>
<span class="k">            ENDDO</span>
<span class="k"> </span><span class="mi">60</span>         <span class="n">j</span> <span class="o">=</span> <span class="n">N</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">IF</span> <span class="p">(</span> <span class="n">X</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="n">XS</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<span class="k">               </span><span class="n">Xr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
            <span class="k">ELSE</span>
<span class="k">               </span><span class="n">ibran</span> <span class="o">=</span> <span class="mi">2</span>
               <span class="k">WRITE</span> <span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99007</span><span class="p">)</span> <span class="n">ibran</span>
               <span class="k">WRITE</span> <span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99006</span><span class="p">)</span> <span class="n">X</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">,</span> <span class="n">XS</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
               <span class="mi">99006</span> <span class="k">FORMAT</span> <span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;X(I) = &#39;</span><span class="p">,</span><span class="n">F15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;   XS(J) = &#39;</span><span class="p">,</span><span class="n">F15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
               <span class="k">STOP</span>
<span class="k">            ENDIF</span>
<span class="k"> </span><span class="mi">80</span>         <span class="n">xprev</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">rprev</span> <span class="o">=</span> <span class="n">Xr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
         <span class="k">ENDDO</span>
<span class="k">      ENDIF</span>
<span class="mi">99007</span> <span class="k">FORMAT</span> <span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;*****INTERNAL ERROR IN RANK SUBROUTINE-- IMPOSSIBLE BRANCH CONDITION AT BRANCH POINT = &#39;</span><span class="p">,</span><span class="n">I0</span><span class="p">)</span>

<span class="k">END SUBROUTINE </span><span class="n">RANK</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2022 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2022-06-15 09:31  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> M_datapac was developed by John S. Urban</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>