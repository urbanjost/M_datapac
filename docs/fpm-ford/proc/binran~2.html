<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Statistics">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>BINRAN &ndash; M_datapac</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">M_datapac </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/programs.html">Programs</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>BINRAN
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.2% of total for procedures.">54 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/M_datapac__s.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/m_datapac__s.f90.html'>M_datapac__s.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/m_datapac__s.html'>M_datapac__s</a></li>
            <li class="breadcrumb-item active" aria-current="page">BINRAN</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/binran~2.html#src">BINRAN</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine BINRAN(N, P, Npar, Iseed, X)  
</h2>
    

    <h2 id="name">NAME</h2>
<div class="codehilite"><pre><span></span><code><span class="nv">binran</span><span class="ss">(</span><span class="mi">3</span><span class="nv">f</span><span class="ss">)</span> <span class="o">-</span> [<span class="nv">M_datapac</span>:<span class="k">RANDOM</span>] <span class="nv">generate</span> <span class="nv">binomial</span> <span class="k">random</span> <span class="nv">numbers</span>
</code></pre></div>

<h2 id="synopsis">SYNOPSIS</h2>
<div class="codehilite"><pre><span></span><code>   SUBROUTINE BINRAN(N,P,Npar,Iseed,X)

    INTEGER,intent(in)        :: N
    REAL(kind=wp),intent(in)  :: P
    INTEGER,intent(in)        :: Npar
    INTEGER,intent(inout)     :: Iseed
    REAL(kind=wp),intent(out) :: X
</code></pre></div>

<h2 id="description">DESCRIPTION</h2>
<div class="codehilite"><pre><span></span><code><span class="nv">BINRAN</span><span class="ss">(</span><span class="mi">3</span><span class="nv">f</span><span class="ss">)</span> <span class="nv">generates</span> <span class="nv">a</span> <span class="k">random</span> <span class="nv">sample</span> <span class="nv">of</span> <span class="nv">size</span> <span class="nv">N</span> <span class="nv">from</span> <span class="nv">the</span> <span class="nv">binomial</span>
<span class="nv">distribution</span> <span class="nv">with</span> <span class="s1">&#39;</span><span class="s">Bernoulli probability</span><span class="s1">&#39;</span> <span class="nv">parameter</span> <span class="o">=</span>
<span class="nv">P</span>, <span class="nv">and</span> <span class="nv">integer</span> <span class="s1">&#39;</span><span class="s">number of bernoulli trials</span><span class="s1">&#39;</span> <span class="nv">parameter</span> <span class="o">=</span> <span class="nv">NPAR</span>.

<span class="nv">The</span> <span class="nv">binomial</span> <span class="nv">distribution</span> <span class="nv">used</span> <span class="nv">herein</span> <span class="nv">has</span> <span class="nv">mean</span> <span class="o">=</span> <span class="nv">NPAR</span><span class="o">*</span><span class="nv">P</span> <span class="nv">and</span> <span class="nv">standard</span>
<span class="nv">deviation</span> <span class="o">=</span> <span class="nv">sqrt</span><span class="ss">(</span><span class="nv">NPAR</span><span class="o">*</span><span class="nv">P</span><span class="o">*</span><span class="ss">(</span><span class="mi">1</span><span class="o">-</span><span class="nv">P</span><span class="ss">))</span>.

<span class="nv">This</span> <span class="nv">distribution</span> <span class="nv">is</span> <span class="nv">defined</span> <span class="k">for</span> <span class="nv">all</span> <span class="nv">discrete</span> <span class="nv">integer</span> <span class="nv">X</span> <span class="nv">between</span> <span class="mi">0</span>
<span class="ss">(</span><span class="nv">inclusively</span><span class="ss">)</span> <span class="nv">and</span> <span class="nv">NPAR</span> <span class="ss">(</span><span class="nv">inclusively</span><span class="ss">)</span>. <span class="nv">This</span> <span class="nv">distribution</span> <span class="nv">has</span> <span class="nv">the</span>
<span class="nv">probability</span> <span class="nv">function</span>

    <span class="nv">f</span><span class="ss">(</span><span class="nv">X</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">c</span><span class="ss">(</span><span class="nv">NPAR</span>,<span class="nv">X</span><span class="ss">)</span> <span class="o">*</span> <span class="nv">P</span><span class="o">**</span><span class="nv">X</span> <span class="o">*</span> <span class="ss">(</span><span class="mi">1</span><span class="o">-</span><span class="nv">P</span><span class="ss">)</span><span class="o">**</span><span class="ss">(</span><span class="nv">NPAR</span><span class="o">-</span><span class="nv">X</span><span class="ss">)</span>

<span class="nv">Where</span> <span class="nv">c</span><span class="ss">(</span><span class="nv">NPAR</span>,<span class="nv">X</span><span class="ss">)</span> <span class="nv">is</span> <span class="nv">the</span> <span class="nv">combinatorial</span> <span class="nv">function</span> <span class="nv">equaling</span> <span class="nv">the</span> <span class="nv">number</span> <span class="nv">of</span>
<span class="nv">combinations</span> <span class="nv">of</span> <span class="nv">NPAR</span> <span class="nv">items</span> <span class="nv">taken</span> <span class="nv">X</span> <span class="nv">at</span> <span class="nv">a</span> <span class="nv">time</span>.

<span class="nv">The</span> <span class="nv">binomial</span> <span class="nv">distribution</span> <span class="nv">is</span> <span class="nv">the</span> <span class="nv">distribution</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">number</span> <span class="nv">of</span>
<span class="nv">successes</span> <span class="nv">in</span> <span class="nv">NPAR</span> <span class="nv">Bernoulli</span> <span class="ss">(</span><span class="mi">0</span>,<span class="mi">1</span><span class="ss">)</span> <span class="nv">trials</span> <span class="nv">where</span> <span class="nv">the</span> <span class="nv">probability</span> <span class="nv">of</span>
<span class="nv">success</span> <span class="nv">in</span> <span class="nv">a</span> <span class="nv">precision</span> <span class="nv">trial</span> <span class="o">=</span> <span class="nv">P</span>.
</code></pre></div>

<h2 id="options">OPTIONS</h2>
<h2 id="input-arguments">INPUT ARGUMENTS</h2>
<p>N      The desired integer number of random numbers to be generated.</p>
<p>P      The value of the &lsquo;Bernoulli probability&rsquo; parameter for the
          binomial distribution. P should be between 0.0 (exclusively)
          and 1.0 (exclusively).</p>
<p>ISEED  An integer iseed value. Should be set to a non-negative value
          to start a new sequence of values. Will be set to -1 on return
          to indicate the next call should continue the current random
          sequence walk.</p>
<p>NPAR   The integer value of the &lsquo;number of Bernoulli trials&rsquo;
          parameter. NPAR should be a positive integer.</p>
<h2 id="output-arguments">OUTPUT ARGUMENTS</h2>
<p>X     A vector (of dimension at least N) into which the generated
         random sample of size N from the binomial distribution
         will be placed; with &lsquo;Bernoulli probability&rsquo; parameter = P
         and &lsquo;number of Bernoulli trials&rsquo; parameter = NPAR.</p>
<h2 id="examples">EXAMPLES</h2>
<p>Sample program:</p>
<div class="codehilite"><pre><span></span><code><span class="nv">program</span> <span class="nv">demo_binran</span>
<span class="nv">use</span> <span class="nv">M_datapac</span>, <span class="nv">only</span> : <span class="nv">binran</span>
<span class="nv">implicit</span> <span class="nv">none</span>
<span class="nv">real</span> :: <span class="nv">x</span><span class="ss">(</span><span class="mi">40</span><span class="ss">)</span>, <span class="nv">P</span>
<span class="nv">integer</span> :: <span class="nv">N</span>, <span class="nv">Npar</span>, <span class="nv">Iseed</span>
   <span class="nv">Iseed</span><span class="o">=</span><span class="mi">0</span>
   <span class="nv">P</span><span class="o">=</span><span class="mi">0</span>.<span class="mi">88</span>
   <span class="nv">N</span><span class="o">=</span><span class="nv">size</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>
   <span class="nv">Npar</span><span class="o">=</span><span class="mi">11111</span>
   <span class="k">call</span> <span class="nl">BINRAN</span><span class="ss">(</span><span class="nv">N</span>,<span class="nv">P</span>,<span class="nv">Npar</span>,<span class="nv">Iseed</span>,<span class="nv">X</span><span class="ss">)</span>
   <span class="nv">write</span><span class="ss">(</span><span class="o">*</span>,<span class="o">*</span><span class="ss">)</span><span class="nv">X</span>
<span class="k">end</span> <span class="nv">program</span> <span class="nv">demo_binran</span>
</code></pre></div>

<p>Results:</p>
<div class="codehilite"><pre><span></span><code>   9746.000       9795.000       9855.000       9805.000       9787.000
   9746.000       9764.000       9774.000       9767.000       9752.000
   9770.000       9784.000       9821.000       9805.000       9784.000
   9734.000       9805.000       9813.000       9792.000       9785.000
   9784.000       9815.000       9785.000       9748.000       9718.000
   9728.000       9824.000       9782.000       9776.000       9850.000
   9770.000       9821.000       9819.000       9724.000       9783.000
   9789.000       9813.000       9798.000       9747.000       9785.000
</code></pre></div>

<h2 id="author">AUTHOR</h2>
<div class="codehilite"><pre><span></span><code>The original DATAPAC library was written by James Filliben of the
Statistical Engineering Division, National Institute of Standards
and Technology.
</code></pre></div>

<h2 id="maintainer">MAINTAINER</h2>
<div class="codehilite"><pre><span></span><code>John Urban, 2022.05.31
</code></pre></div>

<h2 id="license">LICENSE</h2>
<div class="codehilite"><pre><span></span><code>CC0-1.0
</code></pre></div>

<h2 id="references">REFERENCES</h2>
<ul>
<li>Johnson and Kotz, Discrete Distributions, 1969, pages 50-86.</li>
<li>Hastings and Peacock, Statistical Distributions,
     A Handbook for Students and Practitioners, 1975,
     page 41.</li>
<li>Feller, An Introduction to Probability Theory and Its Applications,
     Volume 1, Edition 2, 1957, pages 135-142.</li>
<li>National Bureau of Standards Applied Mathematics
     Series 55, 1964, page 929.</li>
<li>Kendall and Stuart, The Advanced Theory of Statistics,
     Volume 1, Edition 2, 1963, pages 120-125.</li>
<li>Mood and Grable, Introduction to the Theory of Statistics,
     Edition 2, 1963, pages 64-69.</li>
<li>Tocher, The Art Of Simulation, 1963, pages 39-40.</li>
</ul>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-n~121"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>N</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p~40"></span>
              real(kind=wp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>P</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-npar~4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Npar</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iseed~23"></span>
              integer,
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iseed</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~141"></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X</strong>(:)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="k">SUBROUTINE </span><span class="n">BINRAN</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Npar</span><span class="p">,</span><span class="n">Iseed</span><span class="p">,</span><span class="n">X</span><span class="p">)</span><span class="w"></span>
<span class="kt">INTEGER</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="kt">REAL</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">P</span><span class="w"></span>
<span class="kt">INTEGER</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">Npar</span><span class="w"></span>
<span class="kt">INTEGER</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">Iseed</span><span class="w"></span>
<span class="kt">REAL</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">X</span><span class="p">(:)</span><span class="w"></span>

<span class="kt">REAL</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="kt">INTEGER</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ig</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">isum</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!   NOTE THAT EVEN THOUGH THE OUTPUT FROM THIS DISCRETE RANDOM NUMBER</span>
<span class="c">!   GENERATOR MUST NECESSARILY BE A SEQUENCE OF ***INTEGER*** VALUES,</span>
<span class="c">!   THE OUTPUT VECTOR X IS SINGLE PRECISION IN MODE.  X HAS BEEN SPECIFIED</span>
<span class="c">!   AS SINGLE PRECISION SO AS TO CONFORM WITH THE DATAPAC CONVENTION THAT</span>
<span class="c">!   ALL OUTPUT VECTORS FROM ALL THIS CONVENTION IS BASED ON THE BELIEF THAT</span>
<span class="c">!</span>
<span class="c">!    1) A MIXTURE OF MODES (FLOATING POINT VERSUS INTEGER) IS INCONSISTENT</span>
<span class="c">!       AND AN UNNECESSARY COMPLICATION IN A DATA ANALYSIS; AND</span>
<span class="c">!    2) FLOATING POINT MACHINE ARITHMETIC (AS OPPOSED TO INTEGER</span>
<span class="c">!       ARITHMETIC) IS THE MORE NATURAL MODE FOR DOING DATA ANALYSIS.</span>
<span class="c">!</span>
<span class="c">!-----START POINT-----------------------------------------------------</span>
<span class="c">!</span>
<span class="c">!     CHECK THE INPUT ARGUMENTS FOR ERRORS</span>
<span class="c">!</span>
<span class="w">   </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">      WRITE</span><span class="w"> </span><span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99001</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="mi">99001</span><span class="w"> </span><span class="k">FORMAT</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39; ***** FATAL ERROR--THE FIRST INPUT ARGUMENT TO BINRAN(3f) IS NON-POSITIVE *****&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99005</span><span class="p">)</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="k">RETURN</span>
<span class="k">   </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">P</span><span class="o">&lt;=</span><span class="mf">0.0_wp</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">P</span><span class="o">&gt;=</span><span class="mf">1.0_wp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">      WRITE</span><span class="w"> </span><span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99002</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="mi">99002</span><span class="w"> </span><span class="k">FORMAT</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39; ***** FATAL ERROR--THE SECOND INPUT ARGUMENT TO BINRAN(3f) IS OUTSIDE THE ALLOWABLE (0,1) INTERVAL *****&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99003</span><span class="p">)</span><span class="w"> </span><span class="n">P</span><span class="w"></span>
<span class="w">      </span><span class="mi">99003</span><span class="w"> </span><span class="k">FORMAT</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;***** THE VALUE OF THE ARGUMENT IS &#39;</span><span class="p">,</span><span class="n">E15</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39; *****&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">RETURN</span>
<span class="k">   </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Npar</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">      WRITE</span><span class="w"> </span><span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99004</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="mi">99004</span><span class="w">    </span><span class="k">FORMAT</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;***** FATAL ERROR--THE THIRD INPUT ARGUMENT TO BINRAN(3f) IS NON-POSITIVE *****&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99005</span><span class="p">)</span><span class="w"> </span><span class="n">Npar</span><span class="w"></span>
<span class="w">      </span><span class="k">RETURN</span>
<span class="k">   </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">P</span><span class="o">&lt;</span><span class="mf">0.1_wp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="w">      </span><span class="c">!</span>
<span class="w">      </span><span class="c">!     CHECK ON THE MAGNITUDE OF P,</span>
<span class="w">      </span><span class="c">!     AND BRANCH TO THE FASTER</span>
<span class="w">      </span><span class="c">!     GENERATION METHOD ACCORDINGLY.</span>
<span class="w">      </span><span class="c">!</span>
<span class="w">      </span><span class="c">!</span>
<span class="w">      </span><span class="c">!     IF P IS SMALL,</span>
<span class="w">      </span><span class="c">!     GENERATE N BINOMIAL NUMBERS</span>
<span class="w">      </span><span class="c">!     USING THE FACT THAT THE</span>
<span class="w">      </span><span class="c">!     WAITING TIME FOR 1 SUCCESS IN</span>
<span class="w">      </span><span class="c">!     BERNOULLI TRIALS HAS A</span>
<span class="w">      </span><span class="c">!     GEOMETRIC DISTRIBUTION.</span>
<span class="w">      </span><span class="c">!</span>
<span class="w">      </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">         </span><span class="n">isum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">         </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">DO</span>
<span class="k">            CALL </span><span class="n">GEORAN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Iseed</span><span class="p">,</span><span class="n">g</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5_wp</span><span class="w"></span>
<span class="w">            </span><span class="n">isum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ig</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">isum</span><span class="o">&gt;</span><span class="n">Npar</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">X</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">EXIT</span>
<span class="k">            ELSE</span>
<span class="k">               </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">         ENDDO</span>
<span class="k">      ENDDO</span>
<span class="k">      GOTO</span><span class="w"> </span><span class="mi">99999</span><span class="w"></span>
<span class="w">   </span><span class="k">ENDIF</span><span class="w"></span>
<span class="w">   </span><span class="c">!</span>
<span class="w">   </span><span class="c">!     IF P IS MODERATE OR LARGE,</span>
<span class="w">   </span><span class="c">!     GENERATE N BINOMIAL RANDOM NUMBERS</span>
<span class="w">   </span><span class="c">!     USING THE REJECTION METHOD.</span>
<span class="w">   </span><span class="c">!</span>
<span class="w">   </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="n">isum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Npar</span><span class="w"></span>
<span class="w">         </span><span class="k">CALL </span><span class="n">UNIRAN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Iseed</span><span class="p">,</span><span class="n">u</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">P</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">isum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDDO</span>
<span class="k">      </span><span class="n">X</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isum</span><span class="w"></span>
<span class="w">   </span><span class="k">ENDDO</span>
<span class="k">   RETURN</span>
<span class="k">   </span><span class="mi">99005</span><span class="w"> </span><span class="k">FORMAT</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;***** THE VALUE OF THE ARGUMENT IS &#39;</span><span class="p">,</span><span class="n">I0</span><span class="p">,</span><span class="s1">&#39; *****&#39;</span><span class="p">)</span><span class="w"></span>

<span class="mi">99999</span><span class="w"> </span><span class="k">continue</span>
<span class="k">END SUBROUTINE </span><span class="n">BINRAN</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              M_datapac
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:03 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>