<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Statistics">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>POIRAN &ndash; M_datapac</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">M_datapac </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/programs.html">Programs</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>POIRAN
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.1% of total for procedures.">37 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/M_datapac__s.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/m_datapac__s.f90.html'>M_datapac__s.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/m_datapac__s.html'>M_datapac__s</a></li>
            <li class="breadcrumb-item active" aria-current="page">POIRAN</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/poiran~2.html#src">POIRAN</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine POIRAN(N, Alamba, Iseed, X)  
</h2>
    

    <h2 id="name">NAME</h2>
<div class="codehilite"><pre><span></span><code>poiran(3f) - [M_datapac:RANDOM] generate Poisson random numbers
</code></pre></div>

<h2 id="synopsis">SYNOPSIS</h2>
<div class="codehilite"><pre><span></span><code>   SUBROUTINE POIRAN(N,Alamba,Iseed,X)

    INTEGER,intent(in)        :: N
    REAL(kind=wp),intent(in)  :: Alamba
    INTEGER,intent(inout)     :: Iseed
    REAL(kind=wp),intent(out) :: X(:)
</code></pre></div>

<h2 id="description">DESCRIPTION</h2>
<div class="codehilite"><pre><span></span><code>POIRAN(3f) generates a random sample of size N from the Poisson
distribution with REAL tail length parameter = ALAMBA.

The Poisson distribution used herein has mean = ALAMBA and standard
deviation = sqrt(ALAMBA).

This distribution is defined for all discrete non-negative integer
X where X = 0, 1, 2, ... .

This distribution has the probability function

    f(X) = exp(-ALAMBA) <span class="gs">* ALAMBA*</span>*X / X!

The Poisson distribution is the distribution of the number of events
in the interval (0,ALAMBA) when the waiting time between events is
exponentially distributed with mean = 1 and standard deviation = 1.

Note that even though the output from this discrete random number
generator must necessarily be a sequence of ***integer*** values,
the output vector X is REAL in mode.

X has been specified as REAL so as to conform with the DATAPAC
convention that all output vectors from all DATAPAC subroutines
are REAL.  this convention is based on the belief that

1. A mixture of modes (floating point versus integer) is inconsistent
   and an unnecessary complication in a data analysis; and

2. Floating point machine arithmetic (as opposed to integer arithmetic)
   is the more natural mode for doing data analysis.
</code></pre></div>

<h2 id="input-arguments">INPUT ARGUMENTS</h2>
<div class="codehilite"><pre><span></span><code><span class="nv">N</span><span class="w">      </span><span class="nv">The</span><span class="w"> </span><span class="nv">desired</span><span class="w"> </span><span class="nv">integer</span><span class="w"> </span><span class="nv">number</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">numbers</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">generated</span>.

<span class="nv">ISEED</span><span class="w">  </span><span class="nv">An</span><span class="w"> </span><span class="nv">integer</span><span class="w"> </span><span class="nv">seed</span><span class="w"> </span><span class="nv">value</span>.<span class="w"> </span><span class="nv">Should</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">set</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">non</span><span class="o">-</span><span class="nv">negative</span><span class="w"> </span><span class="nv">value</span>
<span class="w">       </span><span class="nv">to</span><span class="w"> </span><span class="nv">start</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">sequence</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">values</span>.<span class="w"> </span><span class="nv">Will</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">set</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="k">return</span>
<span class="w">       </span><span class="nv">to</span><span class="w"> </span><span class="nv">indicate</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="nl">should</span><span class="w"> </span><span class="k">continue</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">current</span><span class="w"> </span><span class="k">random</span>
<span class="w">       </span><span class="nv">sequence</span><span class="w"> </span><span class="nv">walk</span>.

<span class="nv">ALAMBA</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">tail</span><span class="w"> </span><span class="nv">length</span><span class="w"> </span><span class="nv">parameter</span>.<span class="w"> </span><span class="nv">Note</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">tail</span><span class="w"> </span><span class="nv">length</span>
<span class="w">       </span><span class="nv">parameter</span><span class="w"> </span><span class="nv">ALAMBA</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">restricted</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="nv">integer</span><span class="w"> </span><span class="nv">values</span>.<span class="w"> </span><span class="nv">ALAMBA</span>
<span class="w">       </span><span class="nv">can</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">set</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">any</span><span class="w"> </span><span class="nv">positive</span><span class="w"> </span><span class="nv">real</span><span class="w"> </span><span class="nv">value</span><span class="o">--</span><span class="nv">integer</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="nv">non</span><span class="o">-</span><span class="nv">integer</span>.
</code></pre></div>

<h2 id="output-arguments">OUTPUT ARGUMENTS</h2>
<div class="codehilite"><pre><span></span><code><span class="nv">X</span><span class="w">      </span><span class="nv">A</span><span class="w"> </span><span class="nv">vector</span><span class="w"> </span><span class="ss">(</span><span class="nv">of</span><span class="w"> </span><span class="nv">dimension</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">least</span><span class="w"> </span><span class="nv">N</span><span class="ss">)</span><span class="w"> </span><span class="nv">into</span><span class="w"> </span><span class="nv">which</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">generated</span>
<span class="w">       </span><span class="k">random</span><span class="w"> </span><span class="nv">sample</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="nv">N</span><span class="w"> </span><span class="nv">from</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">poisson</span><span class="w"> </span><span class="nv">distribution</span><span class="w"> </span><span class="nv">will</span>
<span class="w">       </span><span class="nv">be</span><span class="w"> </span><span class="nv">placed</span>.
</code></pre></div>

<h2 id="examples">EXAMPLES</h2>
<p>Sample program:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">program</span><span class="w"> </span><span class="nx">demo_poiran</span>
<span class="nx">use</span><span class="w"> </span><span class="nx">m_datapac</span><span class="p">,</span><span class="w"> </span><span class="nx">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nx">poiran</span><span class="p">,</span><span class="w"> </span><span class="nx">plott</span><span class="p">,</span><span class="w"> </span><span class="nx">label</span><span class="p">,</span><span class="w"> </span><span class="nx">plotxt</span><span class="p">,</span><span class="w"> </span><span class="nx">sort</span>
<span class="nx">implicit</span><span class="w"> </span><span class="nx">none</span>
<span class="nx">integer</span><span class="p">,</span><span class="nx">parameter</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="nx">n</span><span class="p">=</span><span class="mi">500</span>
<span class="nx">real</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="nx">x</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span>
<span class="nx">integer</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="nx">iseed</span>
<span class="nx">real</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="nx">alamba</span>
<span class="w">   </span><span class="nx">call</span><span class="w"> </span><span class="nx">label</span><span class="p">(</span><span class="err">&#39;</span><span class="nx">poiran</span><span class="err">&#39;</span><span class="p">)</span>
<span class="w">   </span><span class="nx">alamba</span><span class="p">=</span><span class="m m-Double">2.0</span>
<span class="w">   </span><span class="nx">iseed</span><span class="p">=</span><span class="mi">12345</span>
<span class="w">   </span><span class="nx">call</span><span class="w"> </span><span class="nx">poiran</span><span class="p">(</span><span class="nx">N</span><span class="p">,</span><span class="nx">Alamba</span><span class="p">,</span><span class="nx">Iseed</span><span class="p">,</span><span class="nx">X</span><span class="p">)</span>
<span class="w">   </span><span class="nx">call</span><span class="w"> </span><span class="nx">plotxt</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">n</span><span class="p">)</span>
<span class="w">   </span><span class="nx">call</span><span class="w"> </span><span class="nx">sort</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">!</span><span class="w"> </span><span class="nx">sort</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">show</span><span class="w"> </span><span class="nx">distribution</span>
<span class="w">   </span><span class="nx">call</span><span class="w"> </span><span class="nx">plotxt</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">n</span><span class="p">)</span>
<span class="nx">end</span><span class="w"> </span><span class="nx">program</span><span class="w"> </span><span class="nx">demo_poiran</span>
</code></pre></div>

<p>Results:</p>
<div class="codehilite"><pre><span></span><code> THE FOLLOWING IS A PLOT OF X(I) (VERTICALLY) VERSUS I (HORIZONTALLY
                   I-----------I-----------I-----------I-----------I
  0.7000000E+01 -                                 X
  0.6708333E+01 I
  0.6416667E+01 I
  0.6125000E+01 I        X         XX       X      X   X          X
  0.5833333E+01 I
  0.5541667E+01 I
  0.5250000E+01 -
  0.4958333E+01 I         XX   XXXX   X  X X  X   X     XX    X
  0.4666667E+01 I
  0.4375000E+01 I
  0.4083333E+01 I  XXXX   XXX X XXXXXXX  XX XXXX  XXXXXX  X X XX XX
  0.3791667E+01 I
  0.3500000E+01 -
  0.3208333E+01 I
  0.2916667E+01 I  XXX XXXXXX X   XX XX  XXX  XXXXXXXXXXX X XXXXXXX
  0.2625000E+01 I
  0.2333333E+01 I
  0.2041667E+01 I  XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXXX XXXXXXXXXXXXXX
  0.1750000E+01 -
  0.1458333E+01 I
  0.1166667E+01 I
  0.8750000E+00 I   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
  0.5833335E+00 I
  0.2916670E+00 I
  0.0000000E+00 -  XXXXXXXXXXXXXXX  XX XX XXXXXXXXXXXXX  XX XXXXXX X
                   I-----------I-----------I-----------I-----------I
            0.1000E+01  0.1258E+03  0.2505E+03  0.3752E+03  0.5000E+03

 THE FOLLOWING IS A PLOT OF X(I) (VERTICALLY) VERSUS I (HORIZONTALLY
                   I-----------I-----------I-----------I-----------I
  0.7000000E+01 -                                                  X
  0.6708333E+01 I
  0.6416667E+01 I
  0.6125000E+01 I                                                 XX
  0.5833333E+01 I
  0.5541667E+01 I
  0.5250000E+01 -
  0.4958333E+01 I                                                XX
  0.4666667E+01 I
  0.4375000E+01 I
  0.4083333E+01 I                                            XXXX
  0.3791667E+01 I
  0.3500000E+01 -
  0.3208333E+01 I
  0.2916667E+01 I                                    XXXXXXXXX
  0.2625000E+01 I
  0.2333333E+01 I
  0.2041667E+01 I                        XXXXXXXXXXXXX
  0.1750000E+01 -
  0.1458333E+01 I
  0.1166667E+01 I
  0.8750000E+00 I         XXXXXXXXXXXXXXXX
  0.5833335E+00 I
  0.2916670E+00 I
  0.0000000E+00 -  XXXXXXXX

                   I-----------I-----------I-----------I-----------I
            0.1000E+01  0.1258E+03  0.2505E+03  0.3752E+03  0.5000E+03
</code></pre></div>

<h2 id="author">AUTHOR</h2>
<div class="codehilite"><pre><span></span><code><span class="nx">The</span><span class="w"> </span><span class="nx">original</span><span class="w"> </span><span class="nx">DATAPAC</span><span class="w"> </span><span class="kn">library</span><span class="w"> </span><span class="nx">was</span><span class="w"> </span><span class="nx">written</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">James</span><span class="w"> </span><span class="nx">Filliben</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span>
<span class="nx">Statistical</span><span class="w"> </span><span class="nx">Engineering</span><span class="w"> </span><span class="nx">Division</span><span class="p">,</span><span class="w"> </span><span class="nx">National</span><span class="w"> </span><span class="nx">Institute</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">Standards</span>
<span class="k">and</span><span class="w"> </span><span class="nx">Technology</span><span class="p">.</span>
</code></pre></div>

<h2 id="maintainer">MAINTAINER</h2>
<div class="codehilite"><pre><span></span><code>John Urban, 2022.05.31
</code></pre></div>

<h2 id="license">LICENSE</h2>
<div class="codehilite"><pre><span></span><code>CC0-1.0
</code></pre></div>

<h2 id="references">REFERENCES</h2>
<ul>
<li>Cox and Miller, The Theory of Stochastic Processes, 1965, page 7.</li>
<li>Tocher, The Art of Simulation, 1963, pages 36-37.</li>
<li>Johnson and Kotz, Discrete Distributions, 1969, pages 87-121.</li>
<li>Hastings and Peacock, Statistical Distributions&ndash;A Handbook for
     Students and Practitioners, 1975, pages 108-113.</li>
<li>Feller, An Introduction to Probability Theory and Its Applications,
     Volume 1, Edition 2, 1957, pages 146-154.</li>
<li>National Bureau of Standards Applied Mathematics Series 55, 1964,
     page 929.</li>
</ul>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-n~198"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>N</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-alamba~20"></span>
              real(kind=wp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Alamba</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iseed~37"></span>
              integer,
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iseed</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~237"></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X</strong>(:)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="k">SUBROUTINE </span><span class="n">POIRAN</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Alamba</span><span class="p">,</span><span class="n">Iseed</span><span class="p">,</span><span class="n">X</span><span class="p">)</span>
<span class="kt">INTEGER</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">N</span>
<span class="kt">REAL</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">Alamba</span>
<span class="kt">INTEGER</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">Iseed</span>
<span class="kt">REAL</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">X</span><span class="p">(:)</span>

<span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span>
<span class="kt">REAL</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">sum</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c">!---------------------------------------------------------------------</span>
<span class="w">   </span><span class="c">!</span>
<span class="w">   </span><span class="c">!     CHECK THE INPUT ARGUMENTS FOR ERRORS</span>
<span class="w">   </span><span class="c">!</span>
<span class="w">   </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">      WRITE</span><span class="w"> </span><span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99001</span><span class="p">)</span>
<span class="w">      </span><span class="mi">99001</span><span class="w"> </span><span class="k">FORMAT</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39; ***** FATAL ERROR--The first input argument to POIRAN(3f) is non-positive *****&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99002</span><span class="p">)</span><span class="w"> </span><span class="n">N</span>
<span class="w">      </span><span class="mi">99002</span><span class="w"> </span><span class="k">FORMAT</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;***** The value of the argument is &#39;</span><span class="p">,</span><span class="n">I0</span><span class="p">,</span><span class="s1">&#39; *****&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">RETURN</span>
<span class="k">   ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Alamba</span><span class="o">&lt;=</span><span class="mf">0.0_wp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">      WRITE</span><span class="w"> </span><span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99003</span><span class="p">)</span>
<span class="w">      </span><span class="mi">99003</span><span class="w"> </span><span class="k">FORMAT</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39; ***** FATAL ERROR--The second input argument to POIRAN(3f) is non-positive *****&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="n">G_IO</span><span class="p">,</span><span class="mi">99004</span><span class="p">)</span><span class="w"> </span><span class="n">Alamba</span>
<span class="w">      </span><span class="mi">99004</span><span class="w"> </span><span class="k">FORMAT</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;***** The value of the argument is &#39;</span><span class="p">,</span><span class="n">E15</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39; *****&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">RETURN</span>
<span class="k">   ELSE</span>
<span class="w">      </span><span class="c">!</span>
<span class="w">      </span><span class="c">!     GENERATE N POISSON RANDOM NUMBERS USING THE FACT THAT THE DISTRIBUTION</span>
<span class="w">      </span><span class="c">!     OF EXPONENTIAL WAITING TIMES IS POISSON.</span>
<span class="w">      </span><span class="c">!</span>
<span class="w">      </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span>
<span class="w">         </span><span class="nb">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span>
<span class="w">         </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">         </span><span class="k">DO</span>
<span class="k">            CALL </span><span class="n">UNIRAN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Iseed</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
<span class="w">            </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">LOG</span><span class="p">(</span><span class="mf">1.0_wp</span><span class="o">-</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="nb">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">sum</span><span class="o">&gt;</span><span class="n">Alamba</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">X</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">               </span><span class="k">EXIT</span>
<span class="k">            ELSE</span>
<span class="k">               </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">         ENDDO</span>
<span class="k">      ENDDO</span>
<span class="k">   ENDIF</span>

<span class="k">END SUBROUTINE </span><span class="n">POIRAN</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              M_datapac
 was developed by John S. Urban<br>              &copy; 2024 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-04-30 00:19              </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>